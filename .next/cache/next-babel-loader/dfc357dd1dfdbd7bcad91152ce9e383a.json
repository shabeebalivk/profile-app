{"ast":null,"code":"import Profile from '../../models/Profile';\nimport connectDb from '../../utils/connectDb';\nconnectDb();\nexport default (async (req, res) => {\n  switch (req.method) {\n    case \"GET\":\n      await handleGetRequest(req, res);\n      break;\n\n    case \"POST\":\n      await handlePostRequest(req, res);\n      break;\n\n    case \"DELETE\":\n      await handleDeleteRequest(req, res);\n      break;\n\n    default:\n      res.status(405).send(`Method ${req.method} not allowed`);\n      break;\n  }\n});\n\nasync function handleGetRequest(req, res) {\n  const {\n    _id\n  } = req.query;\n  const profile = await Profile.findOne({\n    _id\n  });\n  res.status(200).json(profile);\n}\n\nasync function handleDeleteRequest(req, res) {\n  const {\n    _id\n  } = req.query;\n  await Profile.findOneAndDelete({\n    _id\n  });\n  res.status(204).json({});\n}\n\nasync function handlePostRequest(req, res) {\n  const {\n    name,\n    age,\n    description,\n    mediaUrl\n  } = req.body;\n\n  try {\n    if (!name || !age || !description || !mediaUrl) {\n      return res.status(422).send('Data missing in one or more fields');\n    }\n\n    const profile = await new Profile({\n      name,\n      age,\n      description,\n      mediaUrl\n    }).save();\n    res.status(201).json(profile);\n  } catch (error) {\n    console.error(error);\n    res.status(500).send(\"Server error in creating profile\");\n  }\n}","map":{"version":3,"sources":["/home/enzyme/Desktop/react/profile-app-send (1)/pages/api/profile.js"],"names":["Profile","connectDb","req","res","method","handleGetRequest","handlePostRequest","handleDeleteRequest","status","send","_id","query","profile","findOne","json","findOneAndDelete","name","age","description","mediaUrl","body","save","error","console"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,sBAApB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AAEAA,SAAS;AAET,gBAAe,OAAOC,GAAP,EAAWC,GAAX,KAAiB;AAC5B,UAAOD,GAAG,CAACE,MAAX;AACI,SAAK,KAAL;AACI,YAAMC,gBAAgB,CAACH,GAAD,EAAKC,GAAL,CAAtB;AACA;;AACJ,SAAK,MAAL;AACI,YAAMG,iBAAiB,CAACJ,GAAD,EAAKC,GAAL,CAAvB;AACA;;AACJ,SAAK,QAAL;AACI,YAAMI,mBAAmB,CAACL,GAAD,EAAKC,GAAL,CAAzB;AACA;;AACJ;AACIA,MAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAsB,UAASP,GAAG,CAACE,MAAO,cAA1C;AACA;AAZR;AAcH,CAfD;;AAiBA,eAAeC,gBAAf,CAAgCH,GAAhC,EAAoCC,GAApC,EAAyC;AACrC,QAAM;AAAEO,IAAAA;AAAF,MAAUR,GAAG,CAACS,KAApB;AACA,QAAMC,OAAO,GAAG,MAAMZ,OAAO,CAACa,OAAR,CAAgB;AAAEH,IAAAA;AAAF,GAAhB,CAAtB;AACAP,EAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqBF,OAArB;AACH;;AAED,eAAeL,mBAAf,CAAmCL,GAAnC,EAAuCC,GAAvC,EAA4C;AACxC,QAAM;AAAEO,IAAAA;AAAF,MAAUR,GAAG,CAACS,KAApB;AACA,QAAMX,OAAO,CAACe,gBAAR,CAAyB;AAACL,IAAAA;AAAD,GAAzB,CAAN;AACAP,EAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAArB;AACH;;AAED,eAAeR,iBAAf,CAAiCJ,GAAjC,EAAqCC,GAArC,EAA0C;AACtC,QAAM;AAAEa,IAAAA,IAAF;AAAQC,IAAAA,GAAR;AAAaC,IAAAA,WAAb;AAA0BC,IAAAA;AAA1B,MAAsCjB,GAAG,CAACkB,IAAhD;;AACA,MAAG;AACC,QAAG,CAACJ,IAAD,IAAS,CAACC,GAAV,IAAiB,CAACC,WAAlB,IAAgC,CAACC,QAApC,EAA6C;AACzC,aAAOhB,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,oCAArB,CAAP;AACH;;AACD,UAAMG,OAAO,GAAG,MAAM,IAAIZ,OAAJ,CAAY;AAC9BgB,MAAAA,IAD8B;AAE9BC,MAAAA,GAF8B;AAG9BC,MAAAA,WAH8B;AAI9BC,MAAAA;AAJ8B,KAAZ,EAKnBE,IALmB,EAAtB;AAMAlB,IAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqBF,OAArB;AACH,GAXD,CAWC,OAAMU,KAAN,EAAY;AACTC,IAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACAnB,IAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kCAArB;AACH;AACJ","sourcesContent":["import Profile from '../../models/Profile'\nimport connectDb from '../../utils/connectDb'\n\nconnectDb();\n\nexport default async (req,res)=>{\n    switch(req.method) {\n        case \"GET\":\n            await handleGetRequest(req,res)\n            break;\n        case \"POST\":\n            await handlePostRequest(req,res)\n            break;\n        case \"DELETE\":\n            await handleDeleteRequest(req,res)\n            break;\n        default:\n            res.status(405).send(`Method ${req.method} not allowed`);\n            break;\n    }\n}\n\nasync function handleGetRequest(req,res) {\n    const { _id } = req.query\n    const profile = await Profile.findOne({ _id})\n    res.status(200).json(profile)\n}\n\nasync function handleDeleteRequest(req,res) {\n    const { _id } = req.query\n    await Profile.findOneAndDelete({_id})\n    res.status(204).json({});\n}\n\nasync function handlePostRequest(req,res) {\n    const { name, age, description, mediaUrl} = req.body\n    try{\n        if(!name || !age || !description|| !mediaUrl){\n            return res.status(422).send('Data missing in one or more fields')\n        }\n        const profile = await new Profile({\n            name,\n            age,\n            description,\n            mediaUrl\n        }).save()\n        res.status(201).json(profile)\n    }catch(error){\n        console.error(error)\n        res.status(500).send(\"Server error in creating profile\")\n    }\n}"]},"metadata":{},"sourceType":"module"}